version: "3"
services:
  healthos-sync:
    image: lscr.io/linuxserver/syncthing:latest
    container_name: healthos-syncthing
    environment:
      - PUID=501 # Standard Mac User ID
      - PGID=20 # Standard Mac Group ID (staff)
      - TZ=Asia/Kolkata
    volumes:
      - ./user_data/logs/inbox:/data/inbox
      - syncthing-config:/config
    ports:
      - 8384:8384 # Web UI
      - 22000:22000/tcp
      - 22000:22000/udp
      - 21027:21027/udp
    restart: unless-stopped

  kitchen-mcp:
    build:
      context: .
      dockerfile: tools/Dockerfile.mcp
    container_name: healthos-kitchen
    volumes:
      - .:/app
      - ./user_data:/app/user_data
    environment:
      - PYTHONPATH=/app
      - HEALTHOS_DATA_DIR=/app/user_data
    # Keep container running so we can exec into it, 
    # or serves as a build definition. 
    # 'tail -f /dev/null' is a common hack to keep non-server containers alive for exec.
    command: tail -f /dev/null

volumes:
  syncthing-config:
